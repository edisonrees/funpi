<!DOCTYPE html>
<html lang="en">
<head>
  <!-- Google tag (gtag.js) -->
<script async src="https://www.googletagmanager.com/gtag/js?id=G-10P71TWFVE"></script>
<script>
  window.dataLayer = window.dataLayer || [];
  function gtag(){dataLayer.push(arguments);}
  gtag('js', new Date());

  gtag('config', 'G-10P71TWFVE');
</script>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>π Playground</title>
  <link href="https://fonts.googleapis.com/css2?family=Linux+Libertine&display=swap" rel="stylesheet">
  <style>
    body {
      font-family: Arial, sans-serif;
      background: #f0f0f0;
      text-align: center;
      padding: 2em;
    }
    .pi-symbol, #piSymbol {
      font-family: 'Linux Libertine', serif !important;
    }
    #piSymbol {
      position: fixed;
      top: 50%;
      left: 50%;
      font-size: 20em;
      font-weight: bold;
      background: linear-gradient(90deg, #c0c0c0, #3b82f6, #6b21a8);
      -webkit-background-clip: text;
      background-clip: text;
      -webkit-text-fill-color: transparent;
      text-shadow: 0 0 0px rgba(0, 0, 0, 0.2);
      pointer-events: none;
      transform: translate(-50%, -50%) scale(0);
      opacity: 0;
      transition: transform 0.4s ease-in-out, opacity 0.4s ease-in-out;
      z-index: 999;
    }
    #helpButton, #piLogoButton {
      position: fixed;
      bottom: 20px;
      width: 50px;
      height: 50px;
      border-radius: 50%;
      color: white;
      font-size: 1.5em;
      font-weight: bold;
      border: none;
      cursor: pointer;
      display: flex;
      justify-content: center;
      align-items: center;
      z-index: 1000;
      transition: background-color 0.2s ease;
    }
    #helpButton {
      right: 20px;
      background-color: #6c757d;
    }
    #helpButton:hover {
      background-color: #5a6268;
    }
    #piLogoButton {
      left: 20px;
      background-color: transparent;
      padding: 0;
    }
    #piLogoButton img {
      width: 40px;
      height: 40px;
      border-radius: 50%;
    }
  </style>
</head>
<body>
  <h1>π Playground</h1>

  <p id="tryHint">Try 355/113!</p>
  <input type="number" id="numInput" placeholder="Numerator">
  <input type="number" id="denInput" placeholder="Denominator">
  <button onclick="checkPi()">Check</button>
  <div id="yourPi"></div>

  <div id="piSymbol">π</div>

  <button id="helpButton" onclick="window.location.href='/funpi/help.html'">?</button>
  <button id="piLogoButton"><img src="data:image/png;base64,<!-- insert logo.html base64 here -->"></button>

  <script>
    // Cookie-triggered redirect
    if (document.cookie.split(';').some(c => c.trim().startsWith('piPortal=true'))) {
      document.cookie = 'piPortal=; max-age=0';
      window.location.href = '/funpi/tan(1.26262725568).html';
    }

    const gradients = [
      "linear-gradient(0deg, #a1c4fd 0%, #c2e9fb 100%)",
      "linear-gradient(0deg, #fbc7a4 0%, #fe938c 50%, #b45f06 100%)"
    ];

    function checkPi() {
      const num = parseFloat(document.getElementById("numInput").value);
      const den = parseFloat(document.getElementById("denInput").value);
      const result = document.getElementById("yourPi");
      const piSymbol = document.getElementById("piSymbol");
      if (isNaN(num) || isNaN(den) || den === 0) {
        result.textContent = "Invalid fraction.";
        return;
      }
      const approx = num / den;
      result.textContent = `Your approximation: ${approx}`;
      document.getElementById('tryHint').style.display = 'none';
      document.cookie = "tried355113=true; max-age=" + (60 * 60 * 24 * 365);
      const error = Math.abs(approx - Math.PI);
      if (error < 0.000001) {
        const gradient = gradients[Math.floor(Math.random() * gradients.length)];
        piSymbol.style.background = gradient;
        piSymbol.style.transform = "translate(-50%, -50%) scale(1.5)";
        piSymbol.style.opacity = "1";
        setTimeout(() => {
          piSymbol.style.transform = "translate(-50%, -50%) scale(0)";
          piSymbol.style.opacity = "0";
        }, 800);
      }
    }

    // π symbol wrapping
    function wrapPiChars(node) {
      if (node.nodeType === Node.TEXT_NODE) {
        const text = node.textContent;
        if (text.includes('π')) {
          const parent = node.parentNode;
          const parts = text.split('π');
          parts.forEach((part, i) => {
            if (part) parent.insertBefore(document.createTextNode(part), node);
            if (i < parts.length - 1) {
              const span = document.createElement('span');
              span.className = 'pi-symbol';
              span.textContent = 'π';
              parent.insertBefore(span, node);
            }
          });
          parent.removeChild(node);
        }
      } else if (node.nodeType === Node.ELEMENT_NODE && !['SCRIPT', 'STYLE'].includes(node.tagName)) {
        Array.from(node.childNodes).forEach(wrapPiChars);
      }
    }
    document.addEventListener('DOMContentLoaded', () => wrapPiChars(document.body));

    // Click + Key combo detection for /funpi/tan redirect
    let clickCount = 0;
    let dPressed = false;
    const logoButton = document.getElementById('piLogoButton');

    logoButton.addEventListener('click', () => {
      clickCount++;
      if (clickCount > 5) clickCount = 5;
    });

    document.addEventListener('keydown', e => {
      if (e.key.toLowerCase() === 'd' && clickCount === 5) {
        document.cookie = 'piPortal=true; max-age=' + (60 * 60 * 24 * 365);
        clickCount = 0;
      }
    });
  </script>
</body>
</html>
